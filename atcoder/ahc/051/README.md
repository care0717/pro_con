# A - Probabilistic Waste Sorting

## 問題概要
N種類のごみを確率的分別器を使って正しい処理装置に振り分ける問題。

## 設定
- **処理場**: 10⁴×10⁴の2次元平面
- **ごみ搬入口**: 座標(0,5000)の1箇所
- **処理装置**: N箇所の設置可能場所、各ごみ種類に1台ずつ設置
- **分別器**: M箇所の設置可能場所、K種類の分別器から選択.同じ分別器を複数設置しても構わない。
- **ベルトコンベア**: 各地点を線分で接続、交差禁止、閉路禁止

## 分別器の動作
- 各分別器は2つの出口を持つ
- 種類jのごみが分別器iの出口1に進む確率: p_{i,j}
- 出口2に進む確率: 1-p_{i,j}

## 制約
- 5≤N≤20 (ごみ種類数)
- 10N≤M≤50N (分別器設置場所数)  
- N≤K≤4N (分別器種類数)
- 0≤p_{i,j}≤1

## 目標
i種類目のごみが、それに対応する処理装置に最終的に運び込まれる確率を q_i と定義する。このとき、以下の絶対スコアが得られる：
各ごみが正しい処理装置に到達する確率q_iを最大化する。

**スコア**: round(10⁹ × (1/N) × Σ(1-q_i)) (小さいほど良い)

## 入出力形式

**入力**:

```
N M K
x₀ᵈ y₀ᵈ
⋮
x_{N-1}ᵈ y_{N-1}ᵈ
x₀ˢ y₀ˢ
⋮
x_{M-1}ˢ y_{M-1}ˢ
p_{0,0} ⋯ p_{0,N-1}
⋮
p_{K-1,0} ⋯ p_{K-1,N-1}
```

- ごみの種類数Nは 5≤N≤20 を満たす。
- 分別器設置場所の個数Mは 10N≤M≤50N を満たす。
- 分別器の種類数Kは N≤K≤4N を満たす。
- i番目の処理装置設置場所の座標 (x_i^d, y_i^d) は、0≤x_i^d, y_i^d ≤10⁴ を満たす整数である。
- i番目の分別器設置場所の座標 (x_i^s, y_i^s) は、0≤x_i^s, y_i^s ≤10⁴ を満たす整数である。
- 搬入口およびすべての設置場所の座標は互いに異なる。
- i番目の分別器が種類jのごみを出口1から運び出す確率 p_{i,j} は実数であり、0≤p_{i,j}≤1 を満たす。

## 出力

ベルトコンベアの行き先を、以下のように番号で表現する。

- 行き先がi番目の処理装置設置場所である場合は i
- 行き先がi番目の分別器設置場所である場合は N+i

i番目の処理装置設置場所に設置する処理装置の番号を d_i (0≤d_i≤N−1) とする。ごみ搬入口から出るベルトコンベアの行き先を表す番号を s (0≤s≤N+M−1) とする。このとき、以下の形式で標準出力に出力せよ。

```
d₀ ⋯ d_{N-1}
s
```

続けて、M行を標準出力に出力せよ。i行目は、i番目の分別器設置場所の状態に応じて以下のように出力する。

**分別器を設置しない場合：**
```
-1
```

**k番目 (0≤k≤K−1) の分別器を設置し、出口1から出るベルトコンベアの行き先を表す番号が v₁、出口2から出るベルトコンベアの行き先を表す番号が v₂ である場合（0≤v₁,v₂≤N+M−1）：**
```
k v₁ v₂
```

ベルトコンベアの行き先が分別器設置場所である場合、そこには分別器が設置されていなければならない。


## 入力生成方法

- rand(L,U)：L以上U以下の整数を一様ランダムに生成する。
- N、M、Kは、それぞれの範囲内から一様ランダムに生成される。

N個の処理装置設置場所とM個の分別器設置場所の座標は、以下の手順でN+M個の座標を順に生成し、前半のN個を処理装置設置場所、後半のM個を分別器設置場所とする。

1. 使用済み座標集合Sを S={(0,5000)} により初期化する。
2. x=rand(0,10⁴),y=rand(0,10⁴) により座標 (x,y) を生成する。
3. 生成した点とのユークリッド距離が100以下の点がSに含まれない場合、この点を採用し、Sに加える。
4. この操作をN+M個の点が生成されるまで繰り返す。

分類確率 p_{i,j} はそれぞれ独立に、rand(1000,9000)×10⁻⁴ により生成される。

---

**実行時間制限:** 2 sec  
**メモリ制限:** 1024 MiB
